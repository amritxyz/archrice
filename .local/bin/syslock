#!/bin/bash

# This script presents a menu of actions (lock, sleep, logout, reboot, shutdown) using `fuzzel`.
# It then executes the selected action, such as locking the screen, suspending the system,
# logging out, or rebooting/shutting down the machine.

# For readable script.
export WM="dwm"
export CTL='systemctl'

lock(){
	wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
	kill -44 $(pidof dwmblocks)
	slock
	wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
	kill -44 $(pidof dwmblocks)
}

choice=$(printf "renew\nlock\nsleep\nlogout\nreboot\nshutdown" | \
	dmenu -i -p 'Action: ')

# Action
case "$choice" in
	'renew') kill -HUP $(pidof $WM) ;;
	'lock') lock ;;
	'sleep') slock $CTL suspend -i ;;
	"logout") pkill -SIGKILL $WM ;;
	'reboot') $CTL reboot -i ;;
	'shutdown') $CTL poweroff -i ;;
	*) exit 1 ;;
esac
